---
// Componente de Calendly Modal/Widget inline optimizado para CSP
---

<!-- Calendly link widget begin -->
<link href="https://assets.calendly.com/assets/external/widget.css" rel="stylesheet">
<script src="https://assets.calendly.com/assets/external/widget.js" type="text/javascript" async></script>

<!-- Versión móvil: Botón con enlace directo -->
<div class="md:hidden">
  <button 
    type="button"
    onclick="openCalendlyPopup()"
    class="btn-accessible btn-hover-lift focus-visible-ring inline-flex items-center justify-center px-6 py-3 bg-green-700 hover:bg-green-800 text-white font-semibold rounded-lg shadow-lg hover:shadow-xl text-sm w-full"
  >
    <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
    </svg>
    Reserva demo
  </button>
</div>

<!-- Versión desktop: Widget inline -->
<div class="hidden md:block">
  <div class="calendly-inline-widget" data-url="https://calendly.com/alanparaa/30min" style="min-width:320px;height:700px;"></div>
</div>

<script>
  // Función para abrir el popup de Calendly de forma segura
  function openCalendlyPopup() {
    try {
      // Verificar si Calendly está disponible
      if (typeof Calendly !== 'undefined' && Calendly.initPopupWidget) {
        Calendly.initPopupWidget({
          url: 'https://calendly.com/alanparaa/30min',
          text: 'Reserva demo',
          color: '#15803d', // green-700
          textColor: '#ffffff'
        });
      } else {
        // Fallback: abrir en nueva pestaña si Calendly no está disponible
        window.open('https://calendly.com/alanparaa/30min', '_blank');
      }
    } catch (error) {
      console.warn('Error al abrir Calendly:', error);
      // Fallback: abrir en nueva pestaña
      window.open('https://calendly.com/alanparaa/30min', '_blank');
    }
  }

  // Inicializar el widget inline cuando el DOM esté listo
  document.addEventListener('DOMContentLoaded', function() {
    // Verificar si Calendly se cargó correctamente
    if (typeof Calendly !== 'undefined') {
      console.log('Calendly cargado correctamente');
    } else {
      console.warn('Calendly no se pudo cargar, usando fallback');
    }
  });
</script>

<!-- Calendly link widget end -->
